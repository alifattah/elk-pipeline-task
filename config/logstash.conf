input {
  beats {
    port => 5044
  }
}

filter {
  # اگر فیلد زمان دارید، این‌جا پارس کنید. مثال:
  # if [timestamp] {
  #   date {
  #     match => ["timestamp", "ISO8601"]
  #     target => "@timestamp"
  #   }
  # }
}

output {
  elasticsearch {
    hosts    => "http://elasticsearch:9200"
    user     => "elastic"
    password => "${ELASTIC_PASSWORD}"
    index    => "app-logs-%{+yyyy.MM.dd}"
  }

  # آرشیو فشرده روی میزبان
  file {
    path  => "/output-archive/%{+yyyy-MM-dd}.log.gz"
    gzip  => true
    codec => line { format => "%{message}" }
  }
}
